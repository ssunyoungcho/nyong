# -*- coding: utf-8 -*-
"""Untitled15.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1yQmwt2whVhOllVjqU28TTllryyv8O35S
"""

import streamlit as st
import requests
from PIL import Image
from io import BytesIO
import pandas as pd
import plotly.express as px

# ìŠ¤íŠ¸ë¦¼ë¦¿ í˜ì´ì§€ ì„¤ì •
st.set_page_config(
    page_title="ê³µê³µë°ì´í„° ì• ë„ë¦¬í‹±ìŠ¤ - 6ì¡° ê¸°ë§ ë°œí‘œ",
    page_icon="ğŸŒ¿",
    layout="wide"
)

# ìŠ¤íŠ¸ë¦¼ë¦¿ ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ë§
st.markdown(
    """
    <style>
    .reportview-container {
        background: #f0fff4;
    }
    .sidebar .sidebar-content {
        background: #e6ffed;
    }
    </style>
    """,
    unsafe_allow_html=True
)

# ì‚¬ì´ë“œë°” ì„¤ì •
with st.sidebar:
    st.markdown("## ê³µê³µë°ì´í„° ì• ë„ë¦¬í‹±ìŠ¤ \n 6ì¡° ê¸°ë§ ë°œí‘œ")
    st.markdown("---")
    st.markdown("### ëª©ì°¨")
    st.markdown("### ì„ í–‰ì—°êµ¬")
    st.markdown("### ë¶„ì„ ê²°ê³¼")
    st.markdown("### Environment (í™˜ê²½)")
    env_options = [
        "ì˜¨ì‹¤ê°€ìŠ¤ ë°°ì¶œëŸ‰", "ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰", "ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ëŒ€ë¹„ ì˜¨ì‹¤ê°€ìŠ¤ ë°°ì¶œëŸ‰",
        "ìš©ìˆ˜ ì‚¬ìš©ëŸ‰", "ì¬ì‚¬ìš© ìš©ìˆ˜ ë¹„ìœ¨", "íê¸°ë¬¼ ë°°ì¶œëŸ‰",
        "íê¸°ë¬¼ ì¬í™œìš© ë¹„ìœ¨", "ëŒ€ê¸°ì˜¤ì—¼ ë°°ì¶œëŸ‰", "ìˆ˜ì§ˆì˜¤ì—¼ ë°°ì¶œëŸ‰"
    ]
    env_dropdown = st.selectbox("Environment ì˜µì…˜ ì„ íƒ", env_options)
    st.markdown("### Social (ì‚¬íšŒ)")
    soc_options = [
        "ìë°œì  ì´ì§ë¥ ", "ì‹ ê·œ ì±„ìš© ë° ê³ ìš© ìœ ì§€", "ì¥ì• ì¸ ê³ ìš©ë¥ ",
        "ì •ê·œì§ ë¹„ìœ¨"
    ]
    soc_dropdown = st.selectbox("Social ì˜µì…˜ ì„ íƒ", soc_options)
    st.markdown("### ì¤‘ì†Œê¸°ì—… ë°ì´í„°")
    sme_options = ["ì¤‘ì†Œê¸°ì—… ê°œìˆ˜", "ì¤‘ì†Œê¸°ì—… ì¢…ì‚¬ì", "ì¤‘ì†Œê¸°ì—… ë§¤ì¶œì•¡"]
    sme_dropdown = st.selectbox("ì¤‘ì†Œê¸°ì—… ë°ì´í„° ì˜µì…˜ ì„ íƒ", sme_options)
    st.markdown("### ì •ì±…ì  ì‹œì‚¬ì ")
    st.markdown("### ë¶„ì„ ë…¸íŠ¸ ğŸ“")

# 'Social (ì‚¬íšŒ)' ë“œë¡­ë‹¤ìš´ì—ì„œ 'ìë°œì  ì´ì§ë¥ ' ì„ íƒ ì‹œ í‘œì‹œí•  ë‚´ìš©
if soc_dropdown == "ìë°œì  ì´ì§ë¥ ":
    st.markdown("## ìë°œì  ì´ì§ë¥ ")
    st.markdown("â€¢ ì¡°ì§ì˜ ì¸ì ìì› ê´€ë¦¬ ìˆ˜ì¤€ì´ ì‚°ì—…í‰ê·  ëŒ€ë¹„ ì ì •í•œ ìˆ˜ì¤€ì„ ìœ ì§€í•˜ë©° ê´€ë¦¬ë˜ê³  ìˆëŠ”ì§€ í™•ì¸")
    st.markdown("â€¢ êµ¬ì„±ì›ì´ ìë°œì ìœ¼ë¡œ ì¡°ì§ì„ ì´ë™í•˜ëŠ” ìë°œì  ì´ì§ë¥ ì„ ì ê²€(ì‚°ì—…ì  íŠ¹ì„± ë°˜ì˜)")

    # ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    data_url = 'https://raw.githubusercontent.com/ssunyoungcho/nyong/main/ì—°ë„ë³„%20ì‚°ì—…ë³„%20ì´ë™ìì´ë™ë¥ .csv'
    df = pd.read_csv(data_url, encoding="utf-8")

    

    # Plotly ì‹œê°í™”
    df['year'] = df['year'].astype(int)
    df_move = df.groupby(['year', 'ì‚°ì—…ëª…'])['ì´ë™ì'].mean().reset_index()
    df_move_sorted = df_move.sort_values(by=['year', 'ì‚°ì—…ëª…'])

    fig = px.line(df_move_sorted, x='year', y='ì´ë™ì', color='ì‚°ì—…ëª…', markers=True,
                  title='ì—°ë„ë³„ ì‚°ì—…ë³„ ì´ë™ì ìˆ˜ ì¶”ì„¸ (5ê°œë…„)',
                  labels={'year': 'ì—°ë„', 'ì´ë™ì': 'ì´ë™ì ìˆ˜'},
                  color_discrete_sequence=px.colors.qualitative.Dark24)
    fig.update_traces(marker=dict(size=10), line=dict(width=3))
    fig.update_layout(legend_title='ì‚°ì—…ë¶„ë¥˜', height=700, plot_bgcolor='#F2F2F2')
    fig.update_xaxes(type='linear')
    fig.update_xaxes(tickvals=[2017, 2018, 2019, 2020, 2021], ticktext=['2017', '2018', '2019', '2020', '2021'])
    fig.update_layout(yaxis=dict(tickformat=',d'))

    st.plotly_chart(fig, use_container_width=True)

  
# ë©”ì¸ í˜ì´ì§€ ì„¤ì •
st.markdown("# ê³µê³µë°ì´í„° ì• ë„ë¦¬í‹±ìŠ¤ - 6ì¡° ê¸°ë§ ë°œí‘œ")
